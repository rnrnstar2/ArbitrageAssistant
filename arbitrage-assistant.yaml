# ArbitrageAssistant - æ­£ã—ã„Haconiwaè¨­è¨ˆï¼ˆå…¬å¼æ§‹é€ ï¼‰
# Organization CRD â†’ Space CRD â†’ Task CRDs

# ==========================================
# Organization CRD - å°‚é–€å®¶ãƒãƒ¼ãƒ å®šç¾©
# ==========================================
apiVersion: haconiwa.dev/v1
kind: Organization
metadata:
  name: arbitrage-assistant-org
  version: "1.0.0"
spec:
  companyName: "ArbitrageAssistant Development"
  industry: "FinTech Software Development"
  basePath: "/Users/rnrnstar/github/ArbitrageAssistant/arbitrage-assistant-org"
  hierarchy:
    departments:
      # CEO Executive Department
      - id: "executive"
        name: "Executive Team"
        description: "Company leadership and strategic decision making"
        roles:
          - roleType: "management"
            title: "Chief Executive Officer"
            agentId: "ceo-main"
            responsibilities:
              - "Strategic vision and direction"
              - "Company-wide decision making"
            environment:
              HACONIWA_ROLE: "CEOç³»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
              HACONIWA_AGENT_ID: "ceo-main"
              HACONIWA_ROOM: "room-ceo"
          - roleType: "coordination"
            title: "Director Coordinator"
            agentId: "director-coordinator"
            responsibilities:
              - "5 Directors management"
              - "Cross-team coordination"
            environment:
              HACONIWA_ROLE: "CEOç³»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
              HACONIWA_AGENT_ID: "director-coordinator"
              HACONIWA_ROOM: "room-ceo"
          - roleType: "monitoring"
            title: "Progress Monitor"
            agentId: "progress-monitor"
            responsibilities:
              - "Performance tracking"
              - "KPI monitoring"
            environment:
              HACONIWA_ROLE: "CEOç³»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
              HACONIWA_AGENT_ID: "progress-monitor"
              HACONIWA_ROOM: "room-ceo"
      
      # Backend Architecture Department
      - id: "backend"
        name: "Backend Architecture Team"
        description: "AWS Amplify Gen2 + GraphQL + DynamoDBå°‚é–€éƒ¨é–€"
        roles:
          - roleType: "management"
            title: "Backend Director"
            agentId: "backend-director"
            responsibilities:
              - "AWS Amplify Gen2æŠ€è¡“çµ±æ‹¬"
              - "GraphQL APIè¨­è¨ˆæ–¹é‡"
            environment:
              HACONIWA_ROLE: "Backendç³»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
              HACONIWA_AGENT_ID: "backend-director"
              HACONIWA_ROOM: "room-backend"
          - roleType: "engineering"
            title: "Amplify Gen2 Specialist"
            agentId: "amplify-gen2-specialist"
            responsibilities:
              - "packages/shared-backend/amplify/data/resource.tså®Ÿè£…"
              - "DynamoDB + GSIè¨­è¨ˆãƒ»å®Ÿè£…"
              - "GraphQL SubscriptionæŠ€è¡“å®Ÿè£…"
            environment:
              HACONIWA_ROLE: "Backendç³»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
              HACONIWA_AGENT_ID: "amplify-gen2-specialist"
              HACONIWA_ROOM: "room-backend"
          - roleType: "engineering"
            title: "Cognito Authentication Expert"
            agentId: "cognito-auth-expert"
            responsibilities:
              - "Amazon CognitoæŠ€è¡“çµ±åˆ"
              - "èªè¨¼ãƒ•ãƒ­ãƒ¼å®Ÿè£…"
      
      # Trading Systems Department
      - id: "trading"
        name: "Trading Systems Team"
        description: "TypeScript + Tauri + é‡‘èè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯å°‚é–€éƒ¨é–€"
        roles:
          - roleType: "management"
            title: "Trading Flow Director"
            agentId: "trading-flow-director"
            responsibilities:
              - "é‡‘èè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯æŠ€è¡“çµ±æ‹¬"
              - "Position-Trail-Actionå®Ÿè£…æ–¹é‡"
          - roleType: "engineering"
            title: "Entry Flow Specialist"
            agentId: "entry-flow-specialist"
            responsibilities:
              - "apps/hedge-system/lib/ä½ç½®å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…"
              - "Entryâ†’Trailâ†’ActionæŠ€è¡“å®Ÿè£…"
          - roleType: "engineering"
            title: "Settlement Flow Specialist"
            agentId: "settlement-flow-specialist"
            responsibilities:
              - "æ±ºæ¸ˆãƒ»ãƒ­ã‚¹ã‚«ãƒƒãƒˆå‡¦ç†æŠ€è¡“å®Ÿè£…"
              - "Trailåˆ¤å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…"
      
      # Integration Systems Department
      - id: "integration"
        name: "Integration Systems Team"
        description: "C++/MQL5 + WebSocket + ea/é–‹ç™ºå°‚é–€éƒ¨é–€"
        roles:
          - roleType: "management"
            title: "Integration Director"
            agentId: "integration-director"
            responsibilities:
              - "MT4/MT5æŠ€è¡“çµ±æ‹¬"
              - "WebSocketé€šä¿¡æ–¹é‡"
          - roleType: "engineering"
            title: "MT5 Connector Specialist"
            agentId: "mt5-connector-specialist"
            responsibilities:
              - "ea/HedgeSystemConnector.mq5å®Ÿè£…"
              - "MQL5ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"
          - roleType: "engineering"
            title: "WebSocket Engineer"
            agentId: "websocket-engineer"
            responsibilities:
              - "ea/websocket-dll/C++å®Ÿè£…"
              - "WebSocketæŠ€è¡“å®Ÿè£…"
      
      # Frontend Experience Department
      - id: "frontend"
        name: "Frontend Experience Team"
        description: "Next.js + React + Tailwind CSSå°‚é–€éƒ¨é–€"
        roles:
          - roleType: "management"
            title: "Frontend Director"
            agentId: "frontend-director"
            responsibilities:
              - "Next.jsæŠ€è¡“çµ±æ‹¬"
              - "UI/UXå®Ÿè£…æ–¹é‡"
          - roleType: "engineering"
            title: "React Specialist"
            agentId: "react-specialist"
            responsibilities:
              - "apps/admin/Next.jså®Ÿè£…"
              - "React + Tailwind CSSå®Ÿè£…"
          - roleType: "engineering"
            title: "Desktop App Engineer"
            agentId: "desktop-app-engineer"
            responsibilities:
              - "apps/hedge-system/Tauriå®Ÿè£…"
              - "Rust + TypeScriptçµ±åˆ"
      
      # DevOps & QA Department
      - id: "devops"
        name: "DevOps & QA Team"
        description: "Turborepo + GitHub Actions + Vitestå°‚é–€éƒ¨é–€"
        roles:
          - roleType: "management"
            title: "DevOps Director"
            agentId: "devops-director"
            responsibilities:
              - "Turborepoãƒ“ãƒ«ãƒ‰æœ€é©åŒ–çµ±æ‹¬"
              - "CI/CDæŠ€è¡“æ–¹é‡"
          - roleType: "engineering"
            title: "Build Optimization Engineer"
            agentId: "build-optimization-engineer"
            responsibilities:
              - "turbo.jsonæœ€é©åŒ–å®Ÿè£…"
              - ".github/workflows/è¨­å®šå®Ÿè£…"
          - roleType: "engineering"
            title: "Quality Assurance Engineer"
            agentId: "quality-assurance-engineer"
            responsibilities:
              - "Vitest + React Testing Libraryå®Ÿè£…"
              - "ESLintå“è³ªãƒã‚§ãƒƒã‚¯å®Ÿè£…"

---
# ==========================================
# Space CRD - é–‹ç™ºç©ºé–“ãƒ»éƒ¨å±‹å®šç¾©
# ==========================================
apiVersion: haconiwa.dev/v1
kind: Space
metadata:
  name: arbitrage-assistant-space
  version: "1.0.0"
spec:
  # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼
  securityPolicy:
    requireAuth: true
    allowedPorts: [3000, 8080, 1420]
    restrictedPaths: [".env*", "*.key"]
  
  # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
  performanceTargets:
    buildTime: "< 30s"
    testCoverage: "> 80%"
  
  # ã‚¿ã‚¹ã‚¯ãƒ–ãƒ©ãƒ³ãƒç®¡ç†
  branchStrategy:
    patterns: ["feature/*", "bugfix/*", "mvp/*"]
    isolationLevel: "room"
    autoCleanup: true
  
  # 6x3 Gridæ§‹æˆï¼ˆ18ãƒšãƒ¼ãƒ³ãƒ»6 Windowï¼‰- ç¾å®Ÿçš„æ§‹æˆ
  grid: "6x3"
  
  # Roomå®šç¾©ï¼ˆå®Ÿéš›ã®Windowæ§‹æˆã«å¯¾å¿œï¼‰
  rooms:
    # Window 0: CEO Executive Office (3 panes)
    - id: "room-ceo"
      name: "ğŸ›ï¸ CEO Executive Office"
      description: "Strategic leadership with 3-pane configuration: Main, Coordination, Monitoring"
      paneCount: 3
      agentIds: ["ceo-main", "director-coordinator", "progress-monitor"]
    
    # Window 1: Backend Architecture (3 panes)
    - id: "room-backend"
      name: "ğŸ—„ï¸ Backend Architecture"
      description: "Backend Director, Amplify Gen2 Specialist, Cognito Authentication Expert"
      paneCount: 3
      agentIds: ["backend-director", "amplify-gen2-specialist", "cognito-auth-expert"]
    
    # Window 2: Trading Systems (3 panes)
    - id: "room-trading"
      name: "âš¡ Trading Systems"
      description: "Trading Flow Director, Entry Flow Specialist, Settlement Flow Specialist"
      paneCount: 3
      agentIds: ["trading-flow-director", "entry-flow-specialist", "settlement-flow-specialist"]
    
    # Window 3: Integration Systems (3 panes)
    - id: "room-integration"
      name: "ğŸ”Œ Integration Systems"
      description: "Integration Director, MT5 Connector Specialist, WebSocket Engineer"
      paneCount: 3
      agentIds: ["integration-director", "mt5-connector-specialist", "websocket-engineer"]
    
    # Window 4: Frontend Experience (3 panes)
    - id: "room-frontend"
      name: "ğŸ¨ Frontend Experience"
      description: "Frontend Director, React Specialist, Desktop App Engineer"
      paneCount: 3
      agentIds: ["frontend-director", "react-specialist", "desktop-app-engineer"]
    
    # Window 5: DevOps & QA (3 panes)
    - id: "room-devops"
      name: "ğŸš€ DevOps & QA"
      description: "DevOps Director, Build Optimization Engineer, Quality Assurance Engineer"
      paneCount: 3
      agentIds: ["devops-director", "build-optimization-engineer", "quality-assurance-engineer"]

  nations:
    - id: arbitrage-nation
      name: "ArbitrageAssistant Nation"
      cities:
        - id: mvp-city
          name: "MVP Development City"
          villages:
            - id: development-village
              name: "Development Village"
              companies:
                - name: arbitrage-assistant
                  basePath: "/Users/rnrnstar/github/ArbitrageAssistant"
                  organizationRef: "arbitrage-assistant-org"
                  
                  gitRepo:
                    url: "https://github.com/rnrnstar2/ArbitrageAssistant"
                    defaultBranch: "dev"
                    auth: "https"
                    
                  buildings:
                    - id: "hq-tower"
                      name: "ArbitrageAssistant HQ Tower"
                      floors:
                        - id: "executive-floor"
                          name: "Executive & Development Floor"
                  
                  agentDefaults:
                    type: "claude-code"
                    permissions:
                      allow:
                        - "Bash(npm run *)"
                        - "Bash(cd *)"
                        - "Bash(git *)"
                        - "Edit(*)"
                        - "Read(*)"
                        - "Write(*)"
                      deny:
                        - "Bash(rm -rf /)"
                        - "Bash(sudo *)"
                    environment:
                      # ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆå®Ÿé¨“çš„ï¼‰
                      variables:
                        HACONIWA_ENVIRONMENT: "arbitrage-assistant"
                        HACONIWA_MVP_MODE: "true"

---
# ==========================================
# Task CRDs - MVPé–‹ç™ºã‚¿ã‚¹ã‚¯å®šç¾©
# ==========================================
apiVersion: haconiwa.dev/v1
kind: Task
metadata:
  name: mvp-graphql-backend
  version: "1.0.0"
spec:
  id: "task-mvp-graphql-backend"
  title: "AWS Amplify Gen2 + DynamoDBå®Ÿè£…"
  description: |
    æŠ€è¡“å®Ÿè£…è¦ä»¶:
    - packages/shared-backend/amplify/data/resource.ts 
    - User/Account/Position/Action GraphQLã‚¹ã‚­ãƒ¼ãƒ
    - GSIè¨­å®š + Cognitoèªè¨¼
    - GraphQL Subscription
    
    å‚ç…§: MVPã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ.mdã€Œ2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã€
  assignee: "amplify-gen2-specialist"
  priority: "high"
  branch: "feature/01_mvp_graphql_backend"
  worktree: true
  spaceRef: "arbitrage-assistant-space"
  room: "room-backend"

---
apiVersion: haconiwa.dev/v1
kind: Task
metadata:
  name: mvp-arbitrage-engine
  version: "1.0.0"
spec:
  id: "task-mvp-arbitrage-engine"
  title: "TypeScript + Tauri é‡‘èè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…"
  description: |
    æŠ€è¡“å®Ÿè£…è¦ä»¶:
    - apps/hedge-system/lib/hedge-system-core.ts
    - apps/hedge-system/lib/position-execution.ts
    - PositionçŠ¶æ…‹é·ç§»ãƒ­ã‚¸ãƒƒã‚¯
    - Trailåˆ¤å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
    
    å‚ç…§: MVPã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ.mdã€Œ4. å®Ÿè¡Œãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´°ã€
  assignee: "trading-flow-director"
  priority: "high"
  branch: "feature/02_mvp_arbitrage_engine"
  worktree: true
  spaceRef: "arbitrage-assistant-space"
  room: "room-trading"

---
apiVersion: haconiwa.dev/v1
kind: Task
metadata:
  name: mvp-mt5-integration
  version: "1.0.0"
spec:
  id: "task-mvp-mt5-integration"
  title: "MQL5 + C++ WebSocketå®Ÿè£…"
  description: |
    æŠ€è¡“å®Ÿè£…è¦ä»¶:
    - ea/HedgeSystemConnector.mq5
    - ea/websocket-dll/HedgeSystemWebSocket.cpp
    - apps/hedge-system/lib/websocket-server.ts
    - MT4/MT5é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«
    
    å‚ç…§: MVPã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ.mdã€Œ7. WebSocketé€šä¿¡è¨­è¨ˆã€
  assignee: "integration-director"
  priority: "high"
  branch: "feature/03_mvp_mt5_integration"
  worktree: true
  spaceRef: "arbitrage-assistant-space"
  room: "room-integration"

---
apiVersion: haconiwa.dev/v1
kind: Task
metadata:
  name: mvp-admin-dashboard
  version: "1.0.0"
spec:
  id: "task-mvp-admin-dashboard"
  title: "Next.js + React + Tailwind CSSå®Ÿè£…"
  description: |
    æŠ€è¡“å®Ÿè£…è¦ä»¶:
    - apps/admin/app/dashboard/page.tsx
    - apps/admin/features/accounts/
    - apps/admin/features/positions/
    - GraphQL Subscriptioné€£æº
    
    å‚ç…§: MVPã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ.mdã€Œ5-4. ç®¡ç†è€…ç”»é¢ã€
  assignee: "frontend-director"
  priority: "high"
  branch: "feature/04_mvp_admin_dashboard"
  worktree: true
  spaceRef: "arbitrage-assistant-space"
  room: "room-frontend"

---
apiVersion: haconiwa.dev/v1
kind: Task
metadata:
  name: mvp-build-optimization
  version: "1.0.0"
spec:
  id: "task-mvp-build-optimization"
  title: "Turborepo + GitHub Actions + Vitestå®Ÿè£…"
  description: |
    æŠ€è¡“å®Ÿè£…è¦ä»¶:
    - turbo.jsonæœ€é©åŒ–è¨­å®š
    - .github/workflows/CI/CDè¨­å®š
    - Vitest + React Testing Library
    - ESLintå“è³ªãƒã‚§ãƒƒã‚¯
    
    å‚ç…§: MVPã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ.mdã€Œ10. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã€
  assignee: "devops-director"
  priority: "medium"
  branch: "enhancement/05_mvp_build_optimization"
  worktree: true
  spaceRef: "arbitrage-assistant-space"
  room: "room-devops"

# Law CRD ã¯ç¾åœ¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ãŸã‚ä¸€æ™‚çš„ã«å‰Šé™¤