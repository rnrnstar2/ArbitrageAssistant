# Task 03: リアルタイムポジション監視システムの実装

## 概要
EA経由でのリアルタイムポジション情報取得と監視機能を実装する。残高、有効証拠金、ポジション状況を1秒以内で更新。

## 実装範囲

### 1. リアルタイムデータ取得
- **EA連携データ**
  - 口座残高・有効証拠金
  - ボーナス額
  - オープンポジション一覧
  - 現在価格・損益
  - 証拠金維持率

### 2. ダッシュボード表示
- **アカウント概要**
  - 接続中クライアントPC一覧
  - 各口座の状態サマリー
  - 全体損益状況

- **ポジション一覧**
  - リアルタイム損益表示
  - ポジション詳細情報
  - アクション可能な操作ボタン

### 3. アラート機能
- **リスク監視**
  - 証拠金維持率低下警告
  - 大幅損失アラート
  - 接続断アラート

## 参考ファイル
- `apps/hedge-system/src/features/monitoring/`
- `apps/admin/features/monitoring/positions/`
- `apps/admin/hooks/monitoring/useRealtimePositions.ts`

## 実装手順

### Phase 1: データ受信機能強化
1. EA向けデータ要求メッセージ定義
2. WebSocketでのリアルタイムデータ受信
3. データ形式の標準化・バリデーション

### Phase 2: ダッシュボードUI実装
4. `src/features/dashboard/` ディレクトリ作成
5. `AccountSummaryDashboard.tsx` - アカウント概要
6. `RealtimePositionGrid.tsx` - ポジション一覧
7. `MarketDataDisplay.tsx` - 市場データ表示

### Phase 3: データ管理・状態管理
8. リアルタイムデータのState管理
9. GraphQL subscriptionとの連携
10. データの永続化・同期

### Phase 4: アラート・通知システム
11. `AlertManager.tsx` - アラート管理
12. 条件監視・通知機能
13. サウンド・デスクトップ通知

## 完了条件
- [ ] 1秒以内のリアルタイムデータ更新
- [ ] 10-50台のクライアントPC対応
- [ ] 接続状態の適切な表示
- [ ] アラート機能の動作確認
- [ ] データの整合性確保
- [ ] エラー時の自動復旧機能

## 注意事項
- WebSocket接続の自動再接続機能必須
- データ更新頻度の最適化（パフォーマンス考慮）
- 大量データ処理時のメモリ使用量管理
- ネットワーク遅延時の適切な表示